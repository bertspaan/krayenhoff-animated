(function(t){function e(e){for(var n,o,s=e[0],c=e[1],l=e[2],d=0,p=[];d<s.length;d++)o=s[d],a[o]&&p.push(a[o][0]),a[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],n=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(n=!1)}n&&(i.splice(e--,1),t=o(o.s=r[0]))}return t}var n={},a={app:0},i=[];function o(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=n,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/krayenhoff-animated/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";var n=r("64a9"),a=r.n(n);a.a},"2d1b":function(t,e,r){"use strict";var n=r("cab2"),a=r.n(n);a.a},4438:function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{class:{scrolling:t.scrolling},attrs:{id:"app"}},[r("div",{staticClass:"panels"},[t._m(0),r("div",{staticClass:"timeline-container"},[r("Timeline",{attrs:{years:t.years,currentYear:t.currentYear,locationIndex:t.locationIndex}})],1)]),r("main",[r("div",{staticClass:"text"},[r("div",{staticClass:"page"}),r("div",{ref:"start"}),r("div",{staticClass:"page"}),r("div",{staticClass:"page"})]),t._l(t.years,function(e){return r("Year",{key:e.year,attrs:{scrollMagic:t.scrollMagic,year:e},on:{progress:t.yearProgress}})}),r("div",{staticClass:"text"},[r("div",{ref:"end"}),r("div",{staticClass:"page"})])],2)])},i=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"map-container"},[r("div",{attrs:{id:"map"}})])}],o=r("cebc"),s=r("768b"),c=(r("ffc1"),r("ac6a"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",[r("div",{ref:"trigger"}),r("div",{style:{height:t.scrollLength+"px"}}),r("div",{staticClass:"spacer"})])}),l=[],u=r("cd29"),d={name:"Year",props:{year:Object,scrollMagic:Object},data:function(){return{pixelsPerLocation:400}},computed:{scrollLength:function(){return(this.year.locations.length+2)*this.pixelsPerLocation}},methods:{padProgress:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,r=0;return t>e&&t<=1-e?r=(t-e)/(1-2*e):t>1-e&&(r=1),r},progress:function(t){var e=this.padProgress(t.progress,0);this.$emit("progress",this.year.year,e)}},mounted:function(){var t=new u.Scene({triggerElement:this.$refs.trigger,duration:this.scrollLength});t.on("progress",this.progress),this.scrollMagic.addScene(t),this.scene=t}},p=d,f=(r("2d1b"),r("2877")),h=Object(f["a"])(p,c,l,!1,null,"9742014a",null),m=h.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("aside",{staticClass:"years"},[r("ol",t._l(t.years,function(e){return r("li",{key:e.year,class:{active:t.currentYear===e.year},style:{height:void 0===t.currentYear?1/t.years.length*80+"%":t.currentYear===e.year?"70%":"45px"}},[r("div",{staticClass:"year"},[r("div",{staticClass:"timeline",class:{active:t.currentYear===e.year}},[r("svg",{attrs:{viewBox:"0 -30 400 1000"}},[r("g",t._l(e.locations,function(n,a){return r("text",{key:a,class:{active:a===t.locationIndex},attrs:{x:"400",y:1e3/(e.locations.length/a)+11}},[t._v("\n                "+t._s(n.properties.place)+"\n              ")])}),0)])]),r("div",{staticClass:"middle"},[r("div",{staticClass:"line"}),r("div",{staticClass:"circle-container"},[t.currentYear===e.year&&t.locationIndex>=0?r("div",{staticClass:"circle",style:{top:"calc("+t.locationIndex/e.locations.length*100+"%)"}}):t._e()])]),r("div",{staticClass:"title"},[r("h3",[t._v(t._s(e.year))]),t.currentYear===e.year?r("div",{staticClass:"timeline",class:{active:t.currentYear===e.year}},[r("svg",{attrs:{viewBox:"0 -30 400 1000"}},[r("g",t._l(e.locations,function(n,a){return r("text",{key:a,class:{active:a===t.locationIndex},attrs:{x:"0",y:1e3/(e.locations.length/a)+11}},[t._v("\n                    "+t._s(t.formatDate(n.properties.date,"dutch"))+"\n                ")])}),0)])]):t._e()])])])}),0)])},v=[],y=(r("28a5"),r("c5f6"),{name:"Timeline",props:{years:Array,currentYear:Number,locationIndex:Number},data:function(){return{months:{dutch:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"]}}},methods:{formatDate:function(t){var e=t.split("-").slice(1,3).map(function(t){return parseInt(t)}),r=Object(s["a"])(e,2),n=r[0],a=r[1];return"".concat(a," ").concat(this.months.dutch[n-1])}}}),b=y,x=(r("97b5"),Object(f["a"])(b,g,v,!1,null,"99140f60",null)),w=x.exports,_=r("bc3a"),j=r("cd29"),C={name:"app",components:{Year:m,Timeline:w},data:function(){return{yearData:void 0,currentYear:void 0,locationIndex:void 0,locations:null,triangles:null,map:void 0,scrollMagic:void 0,scrolling:!1}},watch:{scrolling:function(){!0===this.scrolling&&(window.scrollTo(0,0),window.setInterval(function(){window.scrollBy(0,50)},200))},currentYear:function(){if(void 0!==this.currentYear){var t=new mapboxgl.LngLatBounds;this.yearData.locations.forEach(function(e){t=t.extend(e.geometry.coordinates),e.properties.triangles.forEach(function(e){e.forEach(function(e){t=t.extend(e.coordinates)})})}),this.map.fitBounds(t,{duration:2e3,speed:.3,padding:100,maxZoom:12})}},triangles:function(){var t=this;this.map.getSource("triangles").setData(this.triangles);var e=10;window.start=function(){return window.setTimeout(function(){t.scrolling=!0},1e3*e),"Starting animation in ".concat(e," seconds")}},locations:function(){this.map.getSource("locations").setData(this.locations);var t=new mapboxgl.LngLatBounds;this.locations.features.forEach(function(e){t.extend(e.geometry.coordinates)}),this.bounds=t;var e=this.locations.features.map(function(t){return t.properties.triangles.map(function(e){return{type:"Feature",properties:{timestamp:new Date(t.properties.date).getTime()},geometry:{type:"LineString",coordinates:[t.geometry.coordinates,e[0].coordinates,e[1].coordinates,t.geometry.coordinates]}}})}).flat();this.triangles={type:"FeatureCollection",features:e}}},computed:{years:function(){if(!this.locations)return[];function t(t,e){return t.reduce(function(t,r){return(t[e(r)]=t[e(r)]||[]).push(r),t},{})}var e=t(this.locations.features,function(t){return t.properties.series});return Object.entries(e).map(function(t){var e=Object(s["a"])(t,2),r=e[0],n=e[1];return{year:parseInt(r),locations:n}})}},methods:{zoomOut:function(){this.bounds&&this.map.fitBounds(this.bounds,{duration:2e3,speed:.3,padding:20,maxZoom:12}),this.currentYear=void 0},yearProgress:function(t,e){var r=this;this.currentYear!==t&&(this.currentYear=t,this.yearData=this.years.filter(function(t){return t.year===r.currentYear})[0]);var n,a=this.yearData.locations.length,i=Math.min(Math.floor((a+1)*e)-1,a-1);this.locationIndex=i,n=i<0?new Date(this.yearData.locations[0].properties.date).getTime()-1:new Date(this.yearData.locations[this.locationIndex].properties.date).getTime(),this.setTimestamp(n)},setTimestamp:function(t){this.map.setFilter("locations",["<=","timestamp",t]),this.map.setFilter("triangles",["<=","timestamp",t])},loadLocations:function(){var t=this;_.get("krayenhoff.geojson").then(function(e){var r=e.data;t.locations={type:"FeatureCollection",features:r.features.map(function(t){return Object(o["a"])({},t,{properties:Object(o["a"])({},t.properties,{timestamp:new Date(t.properties.date).getTime()})})})}})},addLayers:function(){this.map.addSource("locations",{type:"geojson",data:this.locations}),this.map.addSource("triangles",{type:"geojson",data:this.triangles}),this.map.addLayer({id:"triangles",type:"line",source:"triangles",paint:{"line-color":"black","line-width":3,"line-opacity":.8}}),this.map.addLayer({id:"locations",type:"circle",source:"locations",paint:{"circle-radius":7,"circle-color":"#ed1c24","circle-opacity":["case",["boolean",["feature-state","visible"],!0],1,0],"circle-opacity-transition":{duration:3e3}}});var t=-7e12;this.setTimestamp(t)}},created:function(){window.addEventListener("keypress",this.keyPress)},mounted:function(){var t=this;this.scrollMagic=new j.Controller;var e=new j.Scene({triggerElement:this.$refs.start,duration:0}),r=new j.Scene({triggerElement:this.$refs.end,duration:0});this.scrollMagic.addScene(e),this.scrollMagic.addScene(r),e.on("enter",this.zoomOut),r.on("enter",this.zoomOut);var n=new mapboxgl.Map({container:"map",style:{version:8,sources:{"krayenhoff-map":{type:"raster",tiles:["https://mapwarper.net/mosaics/tile/1054/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"krayenhoff-map",type:"raster",source:"krayenhoff-map",minzoom:0,maxzoom:14}]},minZoom:6,maxZoom:12,maxBounds:[[1.5,49.8],[8.5,55]],center:[4.7779,52.15],zoom:11});n.on("load",function(){t.addLayers(),t.loadLocations()}),this.map=n}},O=C,Y=(r("034f"),Object(f["a"])(O,a,i,!1,null,null,null)),S=Y.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(S)}}).$mount("#app")},"64a9":function(t,e,r){},"97b5":function(t,e,r){"use strict";var n=r("4438"),a=r.n(n);a.a},cab2:function(t,e,r){}});
//# sourceMappingURL=app.a28d6709.js.map